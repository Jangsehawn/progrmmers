--DATETIME에서 DATE로 형 변환
SELECT ANIMAL_ID, NAME,DATE_FORMAT(DATETIME, '%Y-%m-%d') AS 'DATETIME'
FROM ANIMAL_INS
GROUP BY ANIMAL_ID 
ORDER BY ANIMAL_ID

-- 오랜 기간 보호한 동물(2)

SELECT B.ANIMAL_ID, B.NAME,A.DATETIME AS 'A', B.DATETIME AS 'B'
FROM ANIMAL_INS AS A INNER JOIN ANIMAL_OUTS AS B
ON A.ANIMAL_ID=B.ANIMAL_ID
ORDER BY B.DATETIME-A.DATETIME 
LIMIT 2


-- 중성화 여부 파악하기

SELECT ANIMAL_ID, NAME,(CASE WHEN (SEX_UPON_INTAKE LIKE '%Neutered%') THEN 'O'
                             WHEN (SEX_UPON_INTAKE LIKE '%Spayed%') THEN 'O'
                             ELSE 'X'
                             END) AS '중성화' 
                             
FROM ANIMAL_INS
ORDER BY ANIMAL_ID


-- 이름에 el이 들어가는 동물 찾기

SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE ANIMAL_TYPE ='Dog' AND NAME LIKE '%EL%'
ORDER BY NAME
